extends ../../layout/default.pug

block main
    h1(class="mb-3") Authorization

    if(records)
        
            div(class="text-left")
                button(
                    type="submit"
                    class="btn btn-primary mb-3"
                    button-submit
                ) Update
            table(
                class="table table-hover table-sm"
                table-permissions 
            )
                thead
                    tr
                        th Feature
                        //- Loop through records to show Role Names dynamically if needed
                        each item in records
                            th(class="text-center") #{item.title} 
                tbody
                    //- 3. ID Row: Stores the Role IDs (hidden from view)
                    tr(data-name="id" class="d-none")
                        td
                        each item in records
                            td(class="text-center")
                                input(type="text" value=item.id)

                    //- Permission Rows
                    tr
                        td(colspan="100%")
                            b Product Category

                    tr(data-name="products-category_view")
                        td View
                        each item in records
                            td(class="text-center")
                                input(
                                    type="checkbox" 
                                    checked=(item.permissions.includes("products-category_view"))
                                )

                    tr(data-name="products-category_create")
                        td Create New
                        each item in records
                            td(class="text-center")
                                input(
                                    type="checkbox" 
                                    checked=(item.permissions.includes("products-category_create"))
                                )
                    tr(data-name="products-category_edit")
                        td Edit
                        each item in records
                            td(class="text-center")
                                input(
                                    type="checkbox" 
                                    checked=(item.permissions.includes("products-category_edit"))
                                )
                    tr(data-name="products-category_delete")
                        td Delete
                        each item in records
                            td(class="text-center")
                                input(
                                    type="checkbox" 
                                    checked=(item.permissions.includes("products-category_delete"))
                                )
                    tr
                        td(colspan="100%")
                            b Product 

                    tr(data-name="products_view")
                        td View
                        each item in records
                            td(class="text-center")
                                input(
                                    type="checkbox" 
                                    checked=(item.permissions.includes("products_view"))
                                )

                    tr(data-name="products_create")
                        td Create New
                        each item in records
                            td(class="text-center")
                                input(
                                    type="checkbox" 
                                    checked=(item.permissions.includes("products_create"))
                                )
                    tr(data-name="products_edit")
                        td Edit
                        each item in records
                            td(class="text-center")
                                input(
                                    type="checkbox" 
                                    checked=(item.permissions.includes("products_edit"))
                                )
                    tr(data-name="products_delete")
                        td Delete
                        each item in records
                            td(class="text-center")
                                input(
                                    type="checkbox" 
                                    checked=(item.permissions.includes("products_delete"))
                                )
                    tr
                        td(colspan="100%")
                            b Role

                    tr(data-name="roles_view")
                        td View
                        each item in records
                            td(class="text-center")
                                input(
                                    type="checkbox" 
                                    checked=(item.permissions.includes("roles_view"))
                                )

                    tr(data-name="roles_create")
                        td Create New
                        each item in records
                            td(class="text-center")
                                input(
                                    type="checkbox" 
                                    checked=(item.permissions.includes("roles_create"))
                                )
                    tr(data-name="roles_edit")
                        td Edit
                        each item in records
                            td(class="text-center")
                                input(
                                    type="checkbox" 
                                    checked=(item.permissions.includes("roles_edit"))
                                )
                    tr(data-name="roles_delete")
                        td Delete
                        each item in records
                            td(class="text-center")
                                input(
                                    type="checkbox" 
                                    checked=(item.permissions.includes("roles_delete"))
                                )
    form(
        id="form-change-permissions"
        method="POST"
        action="/admin/roles/permissions?_method=PATCH" 
    )
        div(class="form-group")
            input(
                type="hidden"
                name="permissions"
            )
    //- 4. Link the custom script
    script(src="/admin/js/role.js")